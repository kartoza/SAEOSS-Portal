{#
Displays a date selector in order to let user choose the temporal range for a search query
#}
{% asset "ckanext-saeoss/temporal-query-js" %}


{% set start_identifier = "ext_start_reference_date" %}
{% set end_identifier = "ext_end_reference_date" %}
{% set previous_start = request.args.get(start_identifier) %}
{% set previous_end = request.args.get(end_identifier) %}
{% set today = h.get_today_date() %}

<section id="temporal-search" class="module module-narrow module-shallow">
    <div class="panel panel-default expanded">
    <div class="panel-heading" role="tab" id="headTemporal">
      <h4 class="panel-title">
        <a class="panel-title-link" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseDateRange"
           aria-expanded="true" aria-controls="collapseDateRange" data-module="emc-filter-expand">
          <i class="fa fa-calendar"></i>
            {{ _('Temporal range') }}
        </a>
      </h4>
    </div>
   <div id="collapseDateRange" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
      <div class="panel-body" style="padding: 0px">
    <div class="container-fluid">
        <p>
            <div class="form-horizontal">
                <form role="form" data-toggle="validator" id="fromTemporalQuery">
                <div class="form-group">
                    <label class="control-label col-sm-2" for="{{ start_identifier }}">{{ _("Start") }}</label>
                    <div class="col-sm-10">
                        <input
                                type="date"
                                max="{{ today }}"
                                maxlength="10"
                                oninput="maxLengthCheck(this)"
                                id="{{ start_identifier }}"
                                name="{{ start_identifier }}"
                                class="form-control"
                                form="dataset-search-form"
                                value="{{ previous_start }}"
                                data-module="emc-temporal-query"
                                data-testid="temporal_search-start"
                        />
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="{{ end_identifier }}">{{ _("End") }}</label>
                    <div class="col-sm-10">
                        <input
                                type="date"
                                max="{{ today }}"
                                maxlength="10"
                                oninput="maxLengthCheck(this)"
                                id="{{ end_identifier }}"
                                name="{{ end_identifier }}"
                                class="form-control"
                                form="dataset-search-form"
                                value="{{ previous_end }}"
                                data-module="emc-temporal-query"
                                data-testid="temporal_search-end"
                        />
                    </div>
                </div>
                </form>
            </div>
        </p>
    </div>
      </div>
   </div>
    </div>
</section>
